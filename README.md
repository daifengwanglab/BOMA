# BOMA
Brain and Organoid Manifold Alignment


## Summary
3D organoids cultured from induced human pluripotent stem cells (hiPSCs) are useful models for understanding the longitude genomical dynamics during human brain development, however, the genomic differences between the brains and organoids are not well established. Here, we applied manifold alignment (MA) to comparatively analyze both the bulk and single-cell transcriptomic measurements across time among human brains, human organoids, Non-Human Primates (NHP) organoids within published literatures. Our MA method discovered similar/different developmental patterns across the systems as reported before but in a much simpler manner. More importantly, the developmental trajectories generated by MA served as references for comparing single-cell transcriptomes between human brains and organoids, which allowed us to generate a database summarizing gene expression dynamics across time and cell-types. We experimentally validated some of the discrepancies observed between the two systems. Finally, we leverage our method to align single-cell transcriptomic measurements of human brains (n=57) and organoids (n=35) by integrating data from multiple recent publications. This alignment results demonstrated the capability of our method to integratively and comparatively analyze datasets generated from various experimental sources, which would be useful for understanding brains versus organoids differences and guiding the future organoids protocol design.

## Flow chart
As shown in the flowchart below,here we introduce the comparative analysis pipeline for aligning human and organoid developmental transcriptomic datasets.manifold alignment mainly contains two steps: global alignment and local alignment.


<div align=center><img width="1000" height="500" src="https://github.com/cyang433/human-organoid/blob/main/image/1.png"/></div>

## Software Requirements
The analysis is based on R 4.0. 
Users should install the following packages prior to using the code:
```R
install.packages(c('rdist','SCORPIUS','Rmagic','pheatmap','Linnorm','reshape2','reticulate','plyr','RColorBrewer','stringr','limma','ManiNetCluster','ComplexHeatmap','circlize'))
# import ManiNetCluster form "https://github.com/daifengwanglab/ManiNetCluster"
```
Besides,some functions for processing data are also needed for our project.
```R
source('../src/func.r')
```

## DEMOs
We provided two examples to desmontrate the application of BOMA for RNA-seq datasets alignment between human brain versus organoid.
1. [Align bulk RNA-seq datasets](https://github.com/cyang433/human-organoid)
2. [Align Single-cell RNA-seq datasets] (https://github.com/cyang433/human_organoid_single_cell)

An [online web App](https://github.com/Oafish1/ManiNetCluster-Visualization) to perform alignment with user provided RNA-seq matrices and correspondence matrix.


